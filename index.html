<!DOCTYPE html>
<html lang="vi">
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
<script src="app.js"></script>


<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>ƒêƒÉng k√Ω ƒêH - Mini</title>
    <meta name="description" content="H·ªá th·ªëng ƒëƒÉng k√Ω nhu y·∫øu ph·∫©m h√†ng th√°ng - T∆∞∆°ng th√≠ch m·ªçi thi·∫øt b·ªã">
    <meta name="theme-color" content="#2563eb">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">ƒêƒÉng k√Ω ƒë·ªôc h·∫°i - EMS Qu·∫≠n 3</div>
            <div class="nav-menu">
                <button class="nav-link active" onclick="showPage('register')">ƒêƒÉng k√Ω</button>
                <button class="nav-link" onclick="showPage('summary')">T·ªïng h·ª£p</button>
            </div>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="container">
        <!-- Registration Page -->
        <div id="registerPage" class="page active">
            <div class="page-header">
                <h1>ƒêƒÉng k√Ω s·∫£n ph·∫©m</h1>
                <p class="subtitle">Nh·∫≠p th√¥ng tin v√† ch·ªçn s·∫£n ph·∫©m c·∫ßn ƒëƒÉng k√Ω</p>
            </div>

            <div class="form-section">
                <div class="form-group">
                    <label for="teamSelect" class="form-label">Ch·ªçn nh√≥m <span class="required">*</span></label>
                    <select id="teamSelect" class="form-control" onchange="loadEmployees()" required>
                        <option value="">-- Ch·ªçn nh√≥m --</option>
                        <option value="Team 1">Team 1</option>
                        <option value="Team 2">Team 2</option>
                        <option value="Team 3">Team 3</option>
                        <option value="Team 4">Team 4</option>
                        <option value="Team 5">Team 5</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="employeeSelect" class="form-label">Ch·ªçn nh√¢n vi√™n <span
                            class="required">*</span></label>
                    <select id="employeeSelect" class="form-control" onchange="loadEmployeeBudget()" required disabled>
                        <option value="">-- Ch·ªçn nh√¢n vi√™n --</option>
                    </select>
                </div>

                <!-- Budget Information Section -->
                <div id="budgetSection" class="budget-section" style="display: none;">
                    <div class="budget-header">
                        <h3>üí∞ Th√¥ng tin ng√¢n s√°ch</h3>
                    </div>

                    <div class="budget-customize">
                        <label class="checkbox-label">
                            <input id="customizeBudget" onchange="toggleCustomBudget()">
                            <!-- <span>T√πy ch·ªânh s·ªë ti·ªÅn ƒë∆∞·ª£c mua</span> -->
                        </label>
                        <div id="customBudgetInput" style="display: none;">
                            <input type="number" id="customBudgetAmount" class="form-control" min="0" step="1000"
                                onchange="updateBudgetDisplay()">
                        </div>
                    </div>

                    <div class="budget-info">
                        <div class="budget-item">
                            <span class="budget-label">S·ªë ti·ªÅn ƒë∆∞·ª£c mua:</span>
                            <span class="budget-value" id="allowedBudget">0 ƒë</span>
                        </div>
                        <div class="budget-item">
                            <span class="budget-label">T·ªïng ti·ªÅn ƒëƒÉng k√Ω:</span>
                            <span class="budget-value" id="totalRegistration">0 ƒë</span>
                        </div>
                        <div class="budget-item balance-item">
                            <span class="budget-label">S·ªë d∆∞:</span>
                            <span class="budget-value balance-value" id="remainingBudget">0 ƒë</span>
                        </div>
                    </div>

                    <div class="budget-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" id="budgetProgress"></div>
                        </div>
                        <div class="progress-text" id="budgetProgressText">0%</div>
                    </div>

                    <div id="budgetWarning" class="budget-warning" style="display: none;">
                        ‚ö†Ô∏è V∆∞·ª£t qu√° ng√¢n s√°ch cho ph√©p!
                    </div>
                </div>

                <div class="table-wrapper">
                    <table class="product-table">
                        <thead>
                            <tr>
                                <th style="width: 100px;">M√£ SP</th>
                                <th>T√™n s·∫£n ph·∫©m</th>
                                <th style="width: 120px;">Gi√° l·∫ª<br>(1 h·ªôp)</th>
                                <th style="width: 120px;">Gi√° s·ªâ<br>(1 l·ªëc 4 h·ªôp)</th>
                                <th style="width: 100px;">SL l·∫ª</th>
                                <th style="width: 100px;">SL l·ªëc</th>
                                <th style="width: 130px;">Th√†nh ti·ªÅn</th>
                            </tr>
                        </thead>
                        <tbody id="productTableBody">
                            <!-- Products will be rendered here -->
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="6" class="text-right"><strong>T·ªïng ti·ªÅn ƒëƒÉng k√Ω:</strong></td>
                                <td><strong id="totalAmount">0 ƒë</strong></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>

                <div class="form-actions">
                    <button class="btn btn-primary" onclick="submitRegistration()">
                        <span>‚úì</span> G·ª≠i ƒëƒÉng k√Ω
                    </button>
                </div>
            </div>
        </div>

        <!-- Summary Page -->
        <div id="summaryPage" class="page">
            <div class="page-header">
                <h1>T·ªïng h·ª£p ƒëƒÉng k√Ω</h1>
                <div class="header-actions">
                    <button class="btn btn-success" onclick="exportToExcel()">
                        <span>‚¨á</span> Xu·∫•t Excel
                    </button>
                    <!-- <button class="btn btn-danger" onclick="deleteAllData()">
                        <span>üóë</span> X√≥a t·∫•t c·∫£ d·ªØ li·ªáu
                    </button> -->
                </div>
            </div>

            <!-- Sub Tabs -->
            <div class="tabs">
                <button class="tab-link active" onclick="showTab('byEmployee')">Theo Nh√¢n Vi√™n</button>
                <button class="tab-link" onclick="showTab('byProduct')">Theo S·∫£n Ph·∫©m</button>
                <button class="tab-link" onclick="showTab('byTeam')">Theo Team</button>
            </div>

            <!-- By Employee Tab -->
            <div id="byEmployeeTab" class="tab-content active">
                <div class="table-wrapper">
                    <table class="summary-table">
                        <thead>
                            <tr>
                                <th style="width: 60px;">STT</th>
                                <th style="width: 100px;">Team</th>
                                <th>T√™n nh√¢n vi√™n</th>
                                <th style="width: 120px;">Ng√¢n s√°ch</th>
                                <th style="width: 100px;">M√£ SP</th>
                                <th>T√™n s·∫£n ph·∫©m</th>
                                <th style="width: 90px;">SL l·∫ª</th>
                                <th style="width: 90px;">SL l·ªëc</th>
                                <th style="width: 130px;">Th√†nh ti·ªÅn</th>
                            </tr>
                        </thead>
                        <tbody id="employeeSummaryBody">
                            <!-- Employee summary will be rendered here -->
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="8" class="text-right"><strong>T·ªïng t·∫•t c·∫£:</strong></td>
                                <td><strong id="totalByEmployee">0 ƒë</strong></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>

            <!-- By Team Tab -->
            <div id="byTeamTab" class="tab-content">
                <div class="table-wrapper">
                    <table class="summary-table">
                        <thead>
                            <tr>
                                <th>Team</th>
                                <th style="width: 130px;">S·ªë ng∆∞·ªùi ƒëƒÉng k√Ω</th>
                                <th style="width: 150px;">T·ªïng ng√¢n s√°ch</th>
                                <th style="width: 150px;">T·ªïng ti·ªÅn ƒë√£ mua</th>
                                <th style="width: 150px;">S·ªë d∆∞ chung</th>
                            </tr>
                        </thead>
                        <tbody id="teamSummaryBody">
                            <!-- Team summary will be rendered here -->
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="3" class="text-right"><strong>T·ªïng t·∫•t c·∫£:</strong></td>
                                <td><strong id="totalSpentByTeam">0 ƒë</strong></td>
                                <td><strong id="totalRemainingByTeam">0 ƒë</strong></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>

            <!-- By Product Tab -->
            <div id="byProductTab" class="tab-content">
                <div class="table-wrapper">
                    <table class="summary-table">
                        <thead>
                            <tr>
                                <th style="width: 100px;">M√£ SP</th>
                                <th>T√™n s·∫£n ph·∫©m</th>
                                <th style="width: 110px;">T·ªïng SL l·∫ª</th>
                                <th style="width: 110px;">T·ªïng SL l·ªëc</th>
                                <th style="width: 150px;">T·ªïng th√†nh ti·ªÅn</th>
                            </tr>
                        </thead>
                        <tbody id="productSummaryBody">
                            <!-- Product summary will be rendered here -->
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="4" class="text-right"><strong>T·ªïng t·∫•t c·∫£:</strong></td>
                                <td><strong id="totalByProduct">0 ƒë</strong></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>¬© 2025 H·ªá th·ªëng ƒëƒÉng k√Ω nhu y·∫øu ph·∫©m</p>
        <p class="footer-note">‚ö†Ô∏è L∆∞u √Ω: D·ªØ li·ªáu s·∫Ω b·ªã x√≥a khi t·∫£i l·∫°i trang</p>
    </footer>

    <!-- Success Modal -->
    <div id="successModal" class="modal">
        <div class="modal-content">
            <div class="modal-icon">‚úì</div>
            <h2>ƒêƒÉng k√Ω th√†nh c√¥ng!</h2>
            <p>Th√¥ng tin ƒëƒÉng k√Ω c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c l∆∞u.</p>
        </div>
    </div>

  
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js"></script>
    <script src="app.js"></script>

</body>

</html>